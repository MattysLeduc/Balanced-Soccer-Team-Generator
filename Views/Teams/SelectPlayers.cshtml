@model Balanced_Soccer_Team_Generator.ViewModels.GenerateTeamsVM

@{
    ViewData["Title"] = "Team Generator";
}

<link rel="stylesheet" href="~/css/site.css" />

<h1 class="mb-4">Balanced Soccer Team Generator</h1>

<div class="manage-players-bar">
    <a class="btn-manage" asp-controller="Players" asp-action="Index">Manage Players</a>
    <a class="btn-manage green" asp-controller="Players" asp-action="Create">Add Player</a>
</div>


<div class="team-container">

    <!-- LEFT COLUMN: PLAYER SELECTION -->
    <div class="player-column">

        <h2>Select Players</h2>

        <form asp-action="SelectPlayers" method="post">

            <div class="mb-3">
                <label asp-for="NumberOfTeams" class="form-label"><strong>Number of Teams</strong></label>
                <input asp-for="NumberOfTeams" class="form-control" min="1" />
                <span asp-validation-for="NumberOfTeams" class="text-danger"></span>
            </div>

            <div class="player-list">
                @for (int i = 0; i < Model.Players.Count; i++)
                {
                    <div class="select-player-row">
                        <div>
                            <input asp-for="Players[@i].IsPresent" />
                            <strong style="margin-left:8px">@Model.Players[i].Name</strong>
                        </div>

                        <span class="overall-score">Overall: @Model.Players[i].OverallScore</span>

                        <input type="hidden" asp-for="Players[@i].PlayerId" />
                        <input type="hidden" asp-for="Players[@i].Name" />
                        <input type="hidden" asp-for="Players[@i].OverallScore" />
                    </div>
                }
            </div>

            <button type="submit" class="btn-main mt-3">Generate Teams</button>

        </form>

    </div>



    <!-- RIGHT COLUMN: GENERATED TEAMS -->
    <div class="team-column">

        <h2>Generated Teams</h2>

        @if (ViewBag.GeneratedTeams != null)
        {
            var generatedTeams = (List<Balanced_Soccer_Team_Generator.ViewModels.TeamResultVM>)ViewBag.GeneratedTeams;

            int teamIndex = 1;

            <div>
                @foreach (var team in generatedTeams)
                {
                    <div class="team-card team-@teamIndex">
                        <div class="team-title">@team.TeamName</div>
                        <div class="team-total">Total Score: @team.TotalScore</div>

                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Player</th>
                                    <th>Overall</th>
                                    <th>Rank</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var p in team.Players)
                                {
                                    <tr>
                                        <td>@p.Name</td>
                                        <td>@p.OverallScore</td>
                                        <td>@p.Rank</td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>

                    teamIndex++;
                }
            </div>
        }
        else
        {
            <p class="text-muted">Generate teams to see results here.</p>
        }

    </div>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
